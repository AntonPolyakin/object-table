"use strict";angular.module("objectTable",[]).directive("objectTable",["$compile","$interpolate",function(e,t){return{restrict:"A",replace:!0,templateUrl:"templates/common.html",controller:"objectTableCtrl",controllerAs:"ctrl",transclude:!0,scope:{data:"=",display:"@"},compile:function(e,t){var a=" | offset: currentPage:display |limitTo: display",r="";return t.addFilter&&(a=t.addFilter+a,r+=t.addFilter),("undefined"==typeof t.search||Boolean.valueOf(t.search)())&&(a="| filter:globalSearch"+a,r+="| filter:globalSearch"),e[0].querySelector("#rowTr").setAttribute("ng-repeat","item in data"+a),e.find("pagging").attr("count","(data"+r+").length"),function(e,t,r,n,l){n.init(),l(e,function(t,r){e.$owner=r.$parent;for(var l in t)t.hasOwnProperty(l)&&"THEAD"==t[l].tagName?n.addHeaderPattern(t[l]):"TBODY"==t[l].tagName&&(e.findBody=!0,n.addRowPattern(t[l],a))})}}}}]).filter("offset",function(){return function(e,t,a){if(e){t=parseInt(t,10),a=parseInt(a,10);var r=t*a;return e.slice(r,r+a)}}}),angular.module("objectTable").controller("objectTableCtrl",["$scope","$element","$attrs","$http","$q","$compile","$timeout","$controller","$filter",function(e,t,a,r,n,l,i,o,c){this.init=function(){e.headers=[],e.fields=[],e.display=5,e.currentPage=0,a.headers&&a.headers.split(",").forEach(function(t){e.headers.push(t.trim())}),a.fields&&a.fields.split(",").forEach(function(t){e.fields.push(t.trim())}),e.pagging=!0,a.pagging&&(e.pagging=Boolean.valueOf(a.pagging)()),e.search=!0,a.search&&(e.search=Boolean.valueOf(a.search)()),a.fromUrl&&e.loadExternalData(a.fromUrl),a.display&&(e.display=a.display)},e.loadExternalData=function(t){r.get(t).then(function(t){e.data=t.data})},this.addHeaderPattern=function(e){t.find("table").prepend(e)},this.addRowPattern=function(a,r){angular.element(a).find("tr").attr("ng-repeat","item in data"+r);var n=document.createElement("div");n.appendChild(a),t.find("table").append(n.innerHTML),l(t.find("table"))(e)},this.setCurrentPage=function(t){e.currentPage=t}}]),angular.module("objectTable").controller("paggingTableCtrl",["$scope","$element","$attrs",function(e,t,a){e.currentPage=0,e.prevPage=function(){e.currentPage>0&&e.currentPage--,e.setCurrentPageToTable()},e.nextPage=function(){e.currentPage<e.pageCount()&&e.currentPage++,e.setCurrentPageToTable()},e.setCurrentPageToTable=function(){e.objectTableCtrl.setCurrentPage(e.currentPage)},e.prevPageDisabled=function(){return 0===e.currentPage?"disabled":""},e.pageCount=function(){return e.count>0?Math.ceil(e.count/e.display)-1:1},e.nextPageDisabled=function(){return e.currentPage===e.pageCount()?"disabled":""},e.setPage=function(t){e.currentPage=t,e.setCurrentPageToTable()},e.range=function(){var t=e.pageCount()+1<5?e.pageCount()+1:5,a=[],r=e.currentPage;r>e.pageCount()-t&&(r=e.pageCount()-t+1);for(var n=r;r+t>n;n++)a.push(n);return a}}]),angular.module("objectTable").directive("pagging",["$compile","$interpolate",function(e,t){return{restrict:"E",replace:!0,templateUrl:"templates/pagging.html",controller:"paggingTableCtrl",require:"^objectTable",scope:{count:"=",display:"="},link:function(e,t,a,r){e.objectTableCtrl=r}}}]);
angular.module("objectTable").run(["$templateCache", function($templateCache) {$templateCache.put("templates/common.html","<div>\r\n<div class=\"form-group\">\r\n<input type=\"text\" ng-if=\"search\" placeholder=\"Search\" ng-model=\"$parent.globalSearch\" class=\"pull-right form-control search\">\r\n\r\n<div class=\"sorting-container\" ng-if=\"sorting\">\r\n		Sorting order: <span ng-repeat=\"sortField in sort.fields\" class=\"sorting-badge\">\r\n		<span class=\"fa\" \r\n		ng-class=\"{\'fa-arrow-up\':sort.reverse[$index],\r\n		\'fa-arrow-down\':!sort.reverse[$index]}\" \r\n		></span>\r\n		{{::sortField}}\r\n		<span class=\"fa fa-remove sorting-close\" ng-click=\"removeSorting()\"></span>\r\n	</span>\r\n</div>\r\n\r\n</div>\r\n	<table class=\"table table-responsive table-bordered\">\r\n		<thead ng-if=\"headers.length\" >\r\n			<tr>\r\n				<th ng-repeat=\"head in headers\">{{::head}}</th>\r\n			</tr>\r\n		</thead>\r\n\r\n		<tbody ng-if=\"!findBody\">\r\n\r\n			<tr id=\"rowTr\"><!-- <= will inject ng-repeat -->\r\n				<!-- params: headers and all fields -->\r\n				<td ng-if=\"!fields.length\" ng-repeat=\"(key, prop) in item track by key\">{{prop}}</td>\r\n				<!-- params: headers and fields -->\r\n				<td ng-if=\"fields.length\" ng-repeat=\"field in fields\">{{item[field]}}</td>\r\n			</tr>\r\n\r\n		</tbody>\r\n	</table>\r\n\r\n<pagging ng-if=\"pagging\" data-display=\"display\"></pagging>\r\n\r\n</div>");
$templateCache.put("templates/pagging.html","	<nav ng-hide=\"pageCount()==0\">\r\n		<ul class=\"pagination\">\r\n			<li ng-class=\"prevPageDisabled()\">\r\n				<a href ng-click=\"prevPage()\">« Prev</a>\r\n			</li>\r\n			<li ng-repeat=\"n in range()\"\r\n			ng-class=\"{active: n == currentPage}\" ng-click=\"setPage(n)\">\r\n			<a href=\"#\">{{::n+1}}</a>\r\n		</li>\r\n		<li ng-class=\"nextPageDisabled()\">\r\n			<a href ng-click=\"nextPage()\">Next »</a>\r\n		</li>\r\n	</ul>\r\n</nav>");}]);